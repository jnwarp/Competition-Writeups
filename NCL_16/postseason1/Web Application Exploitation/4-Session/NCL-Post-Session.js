function defaultSession() {
  return '{"username":"guest","secret":"84983c60f7daadc1cb8698621f802c0d9f9a3c3c295c810748fb048115c186ec"}';
}

function obtainSession(sessionCiphertext) {
  var ciphertext = Buffer.from(sessionCiphertext);
  var cipher = crypto.createCipher('aes-128-ctr', PSK);
  var blocks = cipher.update(Buffer.alloc(ciphertext.length, 0x00));
  var plaintext = XOR(ciphertext, blocks);
  return JSON.parse(plaintext);
}

//function validateSession(sessionCiphertext, sessionHmac) { // delimited by -
function validateSession() {
  
  // added myself
  // this is from the cookie given by the website
  sessionCiphertext = '9a1317cb974cdfecd35e87229dae6a69e3daded2c911944103922f4580fe900b3309480f95167ecf6813c4e7a15664621120d860c29a80e95b444c738d47855bd4e1d5bb7192f543f7035900c044b037d016d5ae382dd05c16a0c1d030798e21'
  sessionHmac = 'a1e0967fec3cffeb6bf2f0bce8e4fdce634045a46d873dbe39617652a723f7be'

  var session = obtainSession(sessionCiphertext);
  if (!session) {
    return false;
  }
  var hmac = crypto.createHmac('sha256', session.secret);
  hmac.update(sessionCiphertext);
  if (hmac.digest() !== sessionHmac) {
    window.alert(hmac.digest())
    return false;
  }

  window.alert(hmac.digest())
  return true;
}
